open Nemerle.Collections ;

class C {
  fun Main () : void =
    let cnt = 1000 in
    letfun ins (n : int, m : String_map(int)) : String_map(int) =
      if n < 0 then m
      else ins (n - 1, m#add(string_of_int(n), n))
    in 
    let m = ins (cnt, Map.string_map()) in
    letfun check (n : int) : void =
      if n < 0 then ()
      else
        match m#find(string_of_int(n)) with [
          | option.Some ?x => 
            if x#val != n then
              print_string ("oops\n")
            else
              check(n - 1)
          | option.None =>
              print_string ("oops2\n")
        ]
    in check(cnt);
}
