using System;

module M {
  handler (_ : object, _ : EventArgs) : void
  {
    System.Console.WriteLine ("handler called");
  }

  handler2 (_ : object, _ : EventArgs) : void
  {
    System.Console.WriteLine ("handler2");
  }

  Main () : void
  {
    AppDomain.CurrentDomain.ProcessExit += EventHandler (handler2);
    AppDomain.CurrentDomain.ProcessExit += EventHandler (handler);
    // this adds instead of removing, but this is mono (mcs) bug
    // AppDomain.CurrentDomain.ProcessExit -= EventHandler (handler2);
    System.Console.WriteLine ("main");
  }
}

/*
BEGIN-OUTPUT
main
handler2
handler called
END-OUTPUT
*/
