// warning: line numbers are important here, watch out
using Nemerle.IO;

module A {
  [Nemerle.Diagnostics.Trace (printf ("executing %s:%d:%s () - %s\n", g (_file), _line, _method, _expr))]
  public m () : void {
    def x = 2;
    mutable y = 4;
    for (mutable i = 0; i < x; ++i) {
      y = x * 3 + y;
      y = 2 * y;
      y *= i;
    }
    y -= 1;
  }

  g (x : string) : string { 
    x.Substring (x.Length - 7)
  }


  Main () : void {
    m ();
  }
}

/*
BEGIN-OUTPUT
executing trace.n:8:m () - def x = 2
executing trace.n:9:m () - mutable y = 4
executing trace.n:10:m () - for (mutable i = 0;i < x;++i) {
  y = x * 3 + y;
  y = 2 * y;
  y *= i
}
executing trace.n:11:m () - y = x * 3 + y
executing trace.n:12:m () - y = 2 * y
executing trace.n:13:m () - y *= i
executing trace.n:11:m () - y = x * 3 + y
executing trace.n:12:m () - y = 2 * y
executing trace.n:13:m () - y *= i
executing trace.n:15:m () - y -= 1
END-OUTPUT
*/
