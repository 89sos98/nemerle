using Nemerle.IO;
module M {
  f1 (_ : object) : void {}
  
  class X ['a] {
    a : 'a;
    m () : void { f1 (a) }
  }
  
  f () : void {
    def f2 (acc, v) {
      def (x, y) = acc; 
      printf ("%s\n", x);
      printf ("%s\n", y);
      v
    };
    def _ = f2 (("foo", "bar"), 3);
    ()
  }

  public Main () : void {
    def f2[a] (l) {
      def arr =  (System.Array.CreateInstance (typeof (a), 4) :> array [a]);
      Nemerle.Collections.List.Append (l, [arr[0]])
    };
    def bb (b : list[int], c : list[int] -> list[int]) {
      c(b)
    };
    ignore (bb ([1], f2));
    ()
  }
}



using Nemerle.Collections;

    public class STree
    {
        internal transform_gotos_to_conditionals () : STree { null }
    }


public module Some {

        internal divide_block_into_when_sections () : list [STree]
        {
            def walk (statements, acc1 : list[STree], acc2 : list[STree]) : list [STree]
            {
                match(statements)
                {
                    | [] => []
                    | head :: tail =>
                         walk(tail , head :: acc1 , acc2)
                }
            }

            def sts = [] : list[STree];
            def transformed = List.Map(sts, fun(x ) {x.transform_gotos_to_conditionals ();} );

            walk ( transformed , [] , [])
        }
}




namespace DelayedTyping {

  class A {}

  public class Test {
     public static fooMain() : void {
       def f (x) {
         def (a,b) = x;
         System.Console.WriteLine ($"aaa $a bbb $b");
       }
       def l = [] : list [int * A];
       List.Iter (l, f);

       def e = null : DictionaryEntry [int,int];
       _ = e.KeyValue;
     }
  }
}


using System.Text;

 public class Cxyz
{
  class SomeBase { public foo : int; }
  class DelayedTyping : SomeBase { }

    public static Main42 () : void
    {
          mutable error_dt = null;

          List.Iter ([], fun (dt : DelayedTyping, _) {
                error_dt = dt;
          });

          _ = error_dt.foo;

          def sb = StringBuilder ();
          _ = sb.Append (error_dt);
    }
}

