module M {
  'a run (f : 'a -> int, x : 'a) : int { f (x) }

  fst1 (a : int, b : int) : int { a }
  fst2 (p : int * int) : int { def (a, b) = p; a }
  snd1 (a : int, b : int) : int { b }
  snd2 (p : int * int) : int { def (a, b) = p; b }

  print_int (x : int) : void { print_string (string_of_int (x)) }
  
  Main () : void {
    def fst3 (a : int, b : int) : int { a };
    def fst4 (p : int * int) : int { def (a, b) = p; a };
    def snd3 (a : int, b : int) : int { b };
    def snd4 (p : int * int) : int { def (a, b) = p; b };
  
    print_int (run (fst1, (1, 10)));
    print_int (run (fst2, (2, 10)));
    print_int (run (fst3, (3, 10)));
    print_int (run (fst4, (4, 10)));
    print_int (run (snd1, (10, 5)));
    print_int (run (snd2, (10, 6)));
    print_int (run (snd3, (10, 7)));
    print_int (run (snd4, (10, 8)));
    print_string ("\n")
  }
}

(*
BEGIN-OUTPUT
12345678
END-OUTPUT
*)
