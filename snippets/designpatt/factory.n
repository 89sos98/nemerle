using Nemerle.DesignPatterns;

class X['a] {
  public this (_x : int) { }    
}
class Y { 
  public this (_x : int) { }    
  public this (_x : string) { }    
}

class SX : X[int] {
  public this (x : int) { base (x) }    
}
class SY : Y {
  public this (x : int) { base (x) }    
  public this (x : string) { base (x) }    
}

class W ['a,'b] { }
class Z  { }

[VirtualFactoryMethods (X[int],Y, W [_, string])]
class Factory { }

[VirtualFactoryMethods (Override (SX, X[int]), Override (SY, Y), Z)]
class SubFactory : Factory { }

def f = Factory ();
def sf = SubFactory ();

System.Console.WriteLine (f.CreateX (1));
System.Console.WriteLine (f.CreateY (1));
System.Console.WriteLine (f.CreateY ("aa"));
System.Console.WriteLine (f.CreateW ());
System.Console.WriteLine (sf.CreateX (1));
System.Console.WriteLine (sf.CreateY (1));
System.Console.WriteLine (sf.CreateY ("aa"));
System.Console.WriteLine (sf.CreateW ());
System.Console.WriteLine (sf.CreateZ ());

/*
BEGIN-OUTPUT
X`1[System.Int32]
Y
Y
W`2[System.Object,System.String]
SX
SY
SY
W`2[System.Object,System.String]
Z
END-OUTPUT
*/