using Nemerle.IO;

/*
 * Longest Common Subsequence
 */

using System;


module LCS
{
  private Max (x : int, y : int) : int
  {
    if (x < y) y else x;
  }


  public LcsLength(l : string, r : string) :int
  {
    Console.WriteLine ("Calculating LCS of {0} and {1}...", l, r);

    def arr=array(l.Length+1);
    for(mutable y=1;y<=r.Length;++y)
      for(mutable x=l.Length;x>0;--x){
        arr[x]=
          if(l[x-1]==r[y-1])
            arr[x-1]+1;
          else
            Max(arr[x-1],arr[x]);
      }
    arr[l.Length];
  }


  public Main () : void
  {
    def a = LcsLength ("alamakotazz", "komarezzk");
    Console.WriteLine(a);
    def b = LcsLength ("axbyczd", "exfygzh");
    Console.WriteLine(b);
    ()
  }
}

/*
BEGIN-OUTPUT
Calculating LCS of alamakotazz and komarezzk...
5
Calculating LCS of axbyczd and exfygzh...
3
END-OUTPUT
*/
