
using Nemerle.Attributes;

module M {
  mutable i : int;
  
  [Requires (i >= 0 && i < 5)]
  foo () : void {
    def x = array [1,2,3,4];
    Nemerle.IO.printf ("%d\n", x [i])
  }

//  [Ensures (i >= 0 && i < 5)]
  boo (x : int) : void {
    i <- x;
    Nemerle.IO.printf ("%d\n", x)    
  }

  public Main () : void {
    i <- 2;
    foo ();
    i <- -1;
    try {
      foo ()
    }
    catch {
      | e : AssertionException =>
        Nemerle.IO.printf ("%s\n", e.Message.Substring (e.Message.LastIndexOf (',')));
    };
    boo (3);
    try {
      boo (-1)
    }
    catch {
      | e : AssertionException =>
        Nemerle.IO.printf ("%s\n", e.Message.Substring (e.Message.LastIndexOf (',')));
    };
  }
}

/*
BEGIN-OUTPUT
3
, line 7: Requires not satisfied
3
-1
END-OUTPUT
*/
